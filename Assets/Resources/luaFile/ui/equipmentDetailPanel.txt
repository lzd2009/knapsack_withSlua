local equipmentsInfo = require 'luaFile.infos.equipmentsInfo';

local equipmentDetailPanel = {}

function equipmentDetailPanel:New()
    local o = {};
    self.__index = self;
    setmetatable(o,self);
    o.parent =  GameObject.Find("Canvas").transform;
    o.equipmentDetailPanelGo =GameObject.Instantiate(Resources.Load("Prefabs/EquipmentDetailPanel"), o.parent);
    o.nameText = o.equipmentDetailPanelGo.transform:Find("name"):GetComponent(UI.Text);
    o.descriptionText = o.equipmentDetailPanelGo.transform:Find("description"):GetComponent(UI.Text);
    o.typeText = o.equipmentDetailPanelGo.transform:Find("type"):GetComponent(UI.Text);
    o.rarityText = o.equipmentDetailPanelGo.transform:Find("rarity"):GetComponent(UI.Text);
    o.priceText = o.equipmentDetailPanelGo.transform:Find("price"):GetComponent(UI.Text);
    o.addHpGo = o.equipmentDetailPanelGo.transform:Find("addHp").gameObject;
    o.addAttqackGo = o.equipmentDetailPanelGo.transform:Find("addAttqack").gameObject;
    o.addCountText =  o.equipmentDetailPanelGo.transform:Find("addCount"):GetComponent(UI.Text);
    o.sellBtn = o.equipmentDetailPanelGo.transform:Find("sellBtn"):GetComponent(UI.Button);
    o. equipBtn = o.equipmentDetailPanelGo.transform:Find("equipBtn"):GetComponent(UI.Button);
    o.closeBtn = o.equipmentDetailPanelGo.transform:Find("closeBtn"):GetComponent(UI.Button);
    o.equipmentDetailPanelGo:SetActive(false);
    return o;
end

function equipmentDetailPanel:Show(ShowEquipmentData)
    self.equipmentDetailPanelGo:SetActive(true);
    self.equipmentDetailPanelGo.transform:SetAsLastSibling();
    self.currentShowEquipmentData = ShowEquipmentData;

    local t = equipmentsInfo[ShowEquipmentData.equipmentID];

    self.nameText.text =t.name;
    self.descriptionText.text = t.description;
    self.typeText.text = t.part;
    self.rarityText.text = t.rarity;
    self.priceText.text = t.price;
    if(t.attack ~= 0)then
        self.addHpGo:SetActive(false);
        self.addAttqackGo:SetActive(true);
        self.addCountText.text = t.attack;
    elseif t.hp ~= 0 then
        self.addHpGo:SetActive(true);
        self.addAttqackGo:SetActive(false);
        self.addCountText.text = t.hp;
    end
    self.sellBtn.onClick:AddListener(function()

    end)
    self.equipBtn.onClick:AddListener(function()

    end)
    self.closeBtn.onClick:AddListener(function()
        self.equipmentDetailPanelGo:SetActive(false);
    end)
end


return equipmentDetailPanel;